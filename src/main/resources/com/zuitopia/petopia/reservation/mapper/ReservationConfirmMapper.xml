<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.zuitopia.petopia.reservation.mapper.ReservationConfirmMapper">

    <select id="getStollerCount" resultType="Integer">
        <![CDATA[
            SELECT (20 - reservation_cnt)
            FROM reservation_confirm
            WHERE branch_id = #{branchId} AND reservation_date = #{reservationDate}
        ]]>
    </select>

    <update id="updateStollerCount" parameterType="ReservationConfirmVO">
        UPDATE reservation_confirm
        SET reservation_cnt = reservation_cnt + 1
        WHERE branch_id = #{branchId}
          AND reservation_date = #{reservationDate}
    </update>

    <insert id="insertStollerCount" parameterType="ReservationConfirmVO">
        INSERT INTO reservation_confirm (branch_id, reservation_date, reservation_cnt)
        VALUES (#{branchId}, #{reservationDate}, 1)
    </insert>


</mapper>